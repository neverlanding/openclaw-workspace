# 飞书应用权限推荐报告

> **生成时间**: 2026年2月27日  
> **应用场景**: AI助手与用户进行消息交互

---

## 📋 需求回顾

根据您的使用场景，需要支持以下功能：

| 序号 | 功能需求 | 说明 |
|:---:|:---|:---|
| 1 | 主动发送图片给用户 | 支持发送图片消息 |
| 2 | 主动发起聊天（单聊） | 创建并发送单聊消息 |
| 3 | 与指定的其他联系人聊天 | 向特定用户发送消息 |
| 4 | 在群聊里聊天 | 在群组中发送消息 |

**当前权限状态**: 已有 58 项权限，关键缺失 `im:message:send`

---

## 🔴 P0 - 必须开通的核心权限

以下权限是实现您需求的基础，**必须开通**。

| 权限标识 | 权限名称 | 优先级 | 功能说明 | 对应需求 |
|:---|:---|:---:|:---|:---:|
| `im:message:send` | 发送消息 | **P0** | 向用户或群组发送文本、图片、卡片等各类消息 | 1,2,3,4 |
| `im:message:read` | 读取消息 | **P0** | 接收并读取用户发送的消息（实现双向对话） | 2,3,4 |
| `im:chat:read` | 读取会话信息 | **P0** | 获取会话列表、会话详情，用于管理聊天上下文 | 2,4 |

### 为什么这些权限是必需的？

```
┌─────────────────────────────────────────────────────────┐
│                    消息交互流程                          │
├─────────────────────────────────────────────────────────┤
│  1. 用户发送消息 → im:message:read (接收消息)           │
│  2. 处理用户请求 → im:chat:read (获取会话上下文)        │
│  3. 助手回复消息 → im:message:send (发送消息)           │
└─────────────────────────────────────────────────────────┘
```

- **`im:message:send`**: 这是您当前缺失的关键权限，**没有它无法发送任何消息**
- **`im:message:read`**: 如果不读取消息，就无法知道用户说了什么
- **`im:chat:read`**: 用于识别会话类型（单聊/群聊）和获取会话信息

---

## 🟡 P1 - 建议开通的增强权限

以下权限能显著提升用户体验，**强烈建议开通**。

| 权限标识 | 权限名称 | 优先级 | 功能说明 | 使用场景 |
|:---|:---|:---:|:---|:---|
| `im:resource` | 上传图片/文件资源 | **P1** | 上传图片、文件等资源，获取 resource key 用于发送 | 发送本地图片前需先上传 |
| `im:image:read` | 读取图片内容 | **P1** | 获取用户发送的图片内容，支持图片分析 | 用户发送图片让AI分析 |
| `im:file:read` | 读取文件内容 | **P1** | 获取用户发送的文件内容 | 用户发送文档让AI处理 |
| `im:message.group_msg:send` | 发送群聊消息 | **P1** | 专门用于在群组中发送消息 | 群聊场景（如已开通 im:message:send 可能已包含） |
| `im:message.p2p_msg:send` | 发送单聊消息 | **P1** | 专门用于单聊场景发送消息 | 单聊场景（如已开通 im:message:send 可能已包含） |

### P1 权限价值说明

| 场景 | 需要的权限 | 效果 |
|:---|:---|:---|
| 用户发送一张截图询问内容 | `im:image:read` | AI可以"看到"图片并回答 |
| 助手生成图片后发送给用户 | `im:resource` | 先生成/上传图片，再发送 |
| 用户发送PDF文档要求总结 | `im:file:read` | AI可以读取文档内容 |
| 区分单聊和群聊的响应策略 | `im:message.group_msg:send` + `im:message.p2p_msg:send` | 更精细的消息控制 |

---

## 🟢 P2 - 可选的高级权限

以下权限用于更高级的功能，**根据实际需求选择开通**。

| 权限标识 | 权限名称 | 优先级 | 功能说明 | 适用场景 |
|:---|:---|:---:|:---|:---|
| `im:chat` | 创建和管理会话 | **P2** | 主动创建群聊、管理会话成员 | 需要自动创建群聊时 |
| `contact:user.department:read` | 读取用户部门信息 | **P2** | 获取用户所在部门，用于权限判断 | 企业场景下的部门级功能 |
| `contact:user:read` | 读取用户信息 | **P2** | 获取用户基本信息（姓名、头像等） | 个性化回复、显示用户信息 |
| `contact:contact:read` | 读取通讯录 | **P2** | 获取企业通讯录信息 | 需要查找其他联系人时 |
| `im:message.reaction:read` | 读取消息表情回复 | **P2** | 获取用户对消息的表情回应 | 互动反馈收集 |
| `im:message.reaction:send` | 发送消息表情回复 | **P2** | 对消息添加表情回应 | 快速确认、点赞等轻互动 |
| `im:message.pin:read` | 读取置顶消息 | **P2** | 获取会话中的置顶消息 | 重要信息展示 |
| `im:message.pin:send` | 置顶消息 | **P2** | 将重要消息置顶 | 标记重要回复 |

---

## 📊 权限开通优先级总览

```
优先级金字塔

                    ▲
                   /  \
                  / P2 \      可选高级权限 (8项)
                 /______\
                /        \
               /    P1    \    建议增强权限 (5项)
              /____________\
             /              \
            /       P0       \  必须核心权限 (3项)
           /__________________\
          
          【当前状态】已有58项，缺失关键P0权限
```

### 快速决策表

| 您的需求 | 最低权限要求 | 推荐开通 |
|:---|:---|:---|
| 仅基础文字对话 | `im:message:send` + `im:message:read` | P0 全部 |
| 支持图片收发 | 上述 + `im:resource` + `im:image:read` | P0 + P1 前3项 |
| 支持文件处理 | 上述 + `im:file:read` | P0 + P1 全部 |
| 完整企业功能 | 上述 + P2 相关权限 | P0 + P1 + P2 |

---

## 🔧 开通步骤指南

### 步骤一：登录飞书开放平台

1. 访问 [飞书开放平台](https://open.feishu.cn/)
2. 使用企业管理员账号登录
3. 进入"开发者后台"

### 步骤二：找到您的应用

1. 点击左侧菜单 **"企业自建应用"** 或 **"应用发布"**
2. 找到您的应用（AI助手应用）
3. 点击进入应用详情页

### 步骤三：申请权限

1. 在应用详情页，点击左侧菜单 **"权限管理"**
2. 点击 **"申请权限"** 按钮
3. 在搜索框中输入权限标识，或按分类查找：

| 搜索关键词 | 对应权限 |
|:---|:---|
| "message:send" | `im:message:send` |
| "message:read" | `im:message:read` |
| "chat:read" | `im:chat:read` |
| "resource" | `im:resource` |

### 步骤四：提交审核

1. 勾选需要申请的权限（建议一次性申请 P0 + P1）
2. 填写 **权限使用说明**（参考下方模板）
3. 点击 **"提交审核"**

#### 权限使用说明模板

```
本应用为AI智能助手，需要以下权限实现功能：

1. im:message:send - 用于向用户发送AI回复消息
2. im:message:read - 用于接收用户发送的消息内容
3. im:chat:read - 用于获取会话信息，区分单聊/群聊场景
4. im:resource - 用于上传图片资源后发送给用户
5. im:image:read - 用于读取用户发送的图片进行分析

以上权限仅用于实现AI对话功能，不会用于其他用途。
```

### 步骤五：等待审核

- **审核时间**: 通常 1-3 个工作日
- **审核结果**: 会通过飞书消息通知管理员
- **紧急处理**: 可联系企业超级管理员加速审核

### 步骤六：验证权限

审核通过后，可以通过以下方式验证：

```bash
# 使用飞书 API 测试权限
curl -X GET "https://open.feishu.cn/open-apis/auth/v3/tenant_access_token/internal" \
  -H "Content-Type: application/json" \
  -d '{
    "app_id": "your_app_id",
    "app_secret": "your_app_secret"
  }'
```

或在应用后台查看权限状态：
1. 进入"权限管理"页面
2. 查看已开通权限列表
3. 确认目标权限显示为"已开通"

---

## ⚠️ 权限安全建议

### 1. 最小权限原则

```
✅ 正确做法: 只申请实际需要的权限
❌ 错误做法: 一次性申请所有可能用到的权限
```

**建议**: 先开通 P0 权限实现基础功能，根据实际使用逐步申请 P1/P2。

### 2. 权限使用范围控制

| 措施 | 说明 |
|:---|:---|
| 用户授权确认 | 首次使用时向用户说明需要哪些权限 |
| 敏感操作提示 | 读取文件、图片等操作前征得用户同意 |
| 日志记录 | 记录权限使用情况，便于审计 |

### 3. 数据安全

- **消息内容**: 仅用于处理当前对话，不长期存储
- **用户隐私**: 不收集与功能无关的用户信息
- **传输安全**: 使用 HTTPS 与飞书 API 通信

### 4. 定期审查

建议每季度检查一次：
- [ ] 是否有过期未使用的权限
- [ ] 是否有新功能需要额外权限
- [ ] 权限使用是否符合预期

---

## 📌 总结与行动清单

### 立即行动

| 序号 | 行动项 | 状态 |
|:---:|:---|:---:|
| 1 | 申请 `im:message:send` 权限 | ⬜ 待完成 |
| 2 | 申请 `im:message:read` 权限 | ⬜ 待完成 |
| 3 | 申请 `im:chat:read` 权限 | ⬜ 待完成 |
| 4 | 等待审核通过 | ⬜ 待完成 |
| 5 | 测试消息发送功能 | ⬜ 待完成 |

### 后续优化

| 序号 | 行动项 | 建议时间 |
|:---:|:---|:---|
| 6 | 申请 `im:resource` 权限（支持图片） | 功能上线后1周内 |
| 7 | 申请 `im:image:read` 权限（图片分析） | 有用户需求时 |
| 8 | 申请 `im:file:read` 权限（文件处理） | 有用户需求时 |
| 9 | 评估 P2 高级权限需求 | 功能稳定后 |

---

## 📚 参考资源

- [飞书开放平台 - 权限说明](https://open.feishu.cn/document/home/introduction-to-permissions)
- [飞书开放平台 - 消息 API](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/introduction)
- [飞书开放平台 - 开发指南](https://open.feishu.cn/document/home/develop-a-gadget-in-5-minutes/create-an-app)

---

*本报告由 AI 助手生成，如有疑问请参考飞书官方文档或联系飞书客服。*
