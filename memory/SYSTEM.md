# 🧠 三层记忆系统 v2.0

> 基于 danielmiessler Personal AI Infrastructure 理念设计
> 参考 Jason Zuo 的分层记忆思路
> 部署时间：2026-02-26

---

## 📊 记忆分层架构

### 🔥 P0 - 热记忆（Hot Memory）
**永远在脑子里** - 核心规则、当前任务、最近7天对话

**存储位置：**
- `MEMORY.md` - 长期记忆核心文件
- `memory/YYYY-MM-DD.md` - 最近7天日志
- `AGENTS.md` - 系统规则和行为准则
- `SOUL.md` - 核心人格和价值观

**维护规则：**
- 每次会话自动加载
- 超过7天的日志自动降级到P1
- 核心规则变更立即更新

---

### 🌡️ P1 - 温记忆（Warm Memory）
**需要时能想起来** - 已完成任务、踩过的坑、学到的教训

**存储位置：**
- `memory/lessons/` - 经验教训
- `memory/projects/` - 项目档案
- `memory/decisions/` - 重要决策记录

**维护规则：**
- 每周回顾，提取有价值内容
- 自动归档超过30天的P0内容
- 建立索引便于检索

---

### ❄️ P2 - 冷记忆（Cold Memory）
**长期归档** - 30天前的历史，结构化存储

**存储位置：**
- `memory/archive/` - 归档日志
- `memory/stats/` - 统计数据
- Git历史 - 完整变更记录

**维护规则：**
- 超过90天自动清理
- 保留关键决策和项目总结
- 定期压缩和备份

---

## 🔄 自动维护机制

### 健康检查脚本
```bash
# memory-health.sh - 记忆系统健康检查
# 运行频率：每次心跳或手动执行

检查项：
1. MEMORY.md 行数检查（超过200行触发归档）
2. 旧日志清理（90天+）
3. 敏感信息扫描
4. 索引更新
5. Git备份状态
```

### 安全分级存储
| 级别 | 内容 | 存储方式 |
|------|------|----------|
| 🔴 机密 | API密钥、密码、私人信息 | 加密存储 |
| 🟡 内部 | 工作项目、个人偏好 | 明文存储，访问控制 |
| 🟢 公开 | 通用知识、公开项目 | 明文存储 |

---

## 📝 记忆写入规范

### 什么应该记住？
- ✅ 用户的偏好和习惯
- ✅ 重要的决策和原因
- ✅ 犯过的错误和教训
- ✅ 项目的关键信息
- ✅ 用户的反馈和评价

### 什么不应该记住？
- ❌ 临时性的信息
- ❌ 敏感的个人隐私（除非必要）
- ❌ 已经过时的信息
- ❌ 琐碎的日常对话

---

## 🎯 记忆使用原则

### 读取优先级
1. **P0 热记忆** - 每次会话必加载
2. **P1 温记忆** - 根据上下文选择性加载
3. **P2 冷记忆** - 需要时搜索加载

### 写入触发条件
- 用户明确说"记住这个"
- 重要的决策或约定
- 犯的错误和教训
- 项目里程碑

---

## 🔒 安全保密制度

### 四项检查清单
1. **发送前审核** - 检查是否包含敏感信息
2. **信息分级** - 确认信息公开级别
3. **上下文检查** - 确保不会泄露其他用户/项目信息
4. **最小必要原则** - 只提供必要信息

### 信息分级规则
- **公开级** - 可以分享给任何人
- **内部级** - 仅限当前会话/项目
- **机密级** - 严格保密，需要授权

---

## 📈 系统演进记录

### v2.0 (2026-02-26)
- 引入三层记忆架构
- 建立自动维护机制
- 制定安全保密制度
- 参考 danielmiessler 和 Jason Zuo 的理念

### v1.0 (2026-02-05)
- 基础记忆系统
- MEMORY.md + 每日日志

---

## 🚀 未来改进方向

- [ ] 语义搜索能力
- [ ] 自动摘要生成
- [ ] 记忆关联图谱
- [ ] 跨会话记忆迁移

---

*"一个有记忆的AI和一个没有记忆的AI，区别不是量变，是质变。"*
